# ğŸ› ï¸ Guia de Setup Local - Chatbot BonnaVitta

**Tempo estimado:** 30-45 minutos  
**Dificuldade:** IntermediÃ¡ria

---

## ğŸ“‹ PrÃ©-requisitos

Antes de comeÃ§ar, vocÃª precisa ter instalado:

- **Node.js 18+** - [Download](https://nodejs.org/)
- **SQL Server 2019+** - [Download](https://www.microsoft.com/en-us/sql-server/sql-server-downloads)
- **Git** - [Download](https://git-scm.com/)
- **npm** ou **yarn** (vem com Node.js)

### Verificar InstalaÃ§Ã£o

```bash\n# Node.js\nnode --version\n# Esperado: v18.x.x ou superior\n\n# npm\nnpm --version\n# Esperado: 9.x.x ou superior\n\n# SQL Server (Windows)\nsqlcmd -?\n\n# SQL Server (Mac/Linux com Docker)\ndocker --version\n```\n\n---\n\n## ğŸ”§ InstalaÃ§Ã£o do SQL Server\n\n### Windows\n\n1. Baixe o instalador em https://www.microsoft.com/en-us/sql-server/sql-server-downloads\n2. Execute o instalador\n3. Escolha \"Developer Edition\" (gratuita)\n4. Siga as instruÃ§Ãµes do assistente\n5. Configure SA password (importante!)\n6. Instale SQL Server Management Studio (SSMS)\n\n### Mac/Linux (Docker)\n\n```bash\n# Instalar Docker primeiro\n# https://www.docker.com/products/docker-desktop\n\n# Executar SQL Server em container\ndocker run -e \"ACCEPT_EULA=Y\" -e \"SA_PASSWORD=YourPassword123!\" \\\n  -p 1433:1433 \\\n  -d mcr.microsoft.com/mssql/server:2019-latest\n\n# Instalar sqlcmd\nnpm install -g sql-cli\n```\n\n### Testar ConexÃ£o\n\n```bash\n# Windows/Mac/Linux\nsqlcmd -S localhost -U sa -P \"YourPassword123!\" -Q \"SELECT @@VERSION\"\n```\n\n---\n\n## ğŸ“¦ Clonar e Instalar Projeto\n\n### 1. Clonar RepositÃ³rio\n\n```bash\n# Via HTTPS\ngit clone https://github.com/seu-usuario/chatbot-bonnavitta.git\ncd chatbot-bonnavitta-bot-tradicional\n\n# Ou via SSH\ngit clone git@github.com:seu-usuario/chatbot-bonnavitta.git\ncd chatbot-bonnavitta-bot-tradicional\n```\n\n### 2. Instalar DependÃªncias\n\n```bash\nnpm install\n# Ou com yarn\nyarn install\n```\n\n**Tempo:** 3-5 minutos\n\n### 3. Configurar VariÃ¡veis de Ambiente\n\n```bash\n# Copiar arquivo de exemplo\ncp .env.example .env\n\n# Editar com suas credenciais\n# Abra .env em seu editor favorito\n```\n\n**Arquivo .env:**\n\n```env\n# Servidor\nNODE_ENV=development\nPORT=8000\n\n# Banco de Dados\nDATABASE_HOST=localhost\nDATABASE_PORT=1433\nDATABASE_DATABASE=BonnaVitta\nDATABASE_USERNAME=sa\nDATABASE_PASSWORD=YourPassword123!\nDATABASE_AUTHENTICATION=default\n\n# JWT\nJWT_SECRET=sua-chave-secreta-muito-segura-aqui\nJWT_EXPIRATION=24h\n\n# Telegram\nTELEGRAM_BOT_TOKEN=seu-token-do-bot-telegram\nTELEGRAM_WEBHOOK_URL=https://seu-dominio.com/api/webhook/telegram\n\n# WhatsApp\nWHATSAPP_ACCESS_TOKEN=seu-token-de-acesso-whatsapp\nWHATSAPP_PHONE_NUMBER_ID=seu-numero-de-telefone-id\nWHATSAPP_WEBHOOK_TOKEN=seu-token-de-verificacao\n\n# Logging\nLOG_LEVEL=info\nLOG_DIR=./logs\n\n# CORS\nCORS_ORIGIN=*\n```\n\n---\n\n## ğŸ—„ï¸ Criar Banco de Dados\n\n### 1. Criar Banco\n\n```bash\n# Windows\nsqlcmd -S localhost -U sa -P \"YourPassword123!\" -Q \"CREATE DATABASE BonnaVitta\"\n\n# Mac/Linux\nsqlcmd -S localhost -U sa -P \"YourPassword123!\" -Q \"CREATE DATABASE BonnaVitta\"\n```\n\n### 2. Executar Scripts SQL\n\n```bash\n# Criar schema (tabelas, views)\nsqlcmd -S localhost -U sa -P \"YourPassword123!\" -d BonnaVitta -i scripts/01_create_schema.sql\n\n# Criar Stored Procedures\nsqlcmd -S localhost -U sa -P \"YourPassword123!\" -d BonnaVitta -i scripts/02_create_sps.sql\n\n# Popular com dados de exemplo\nsqlcmd -S localhost -U sa -P \"YourPassword123!\" -d BonnaVitta -i scripts/03_seed_data.sql\n```\n\n### 3. Verificar Banco\n\n```bash\n# Conectar ao banco\nsqlcmd -S localhost -U sa -P \"YourPassword123!\" -d BonnaVitta\n\n# No prompt do sqlcmd, execute:\n> SELECT COUNT(*) FROM Usuarios;\n> SELECT COUNT(*) FROM Vendas;\n> GO\n```\n\nVocÃª deve ver dados de exemplo.\n\n---\n\n## ğŸš€ Executar a AplicaÃ§Ã£o\n\n### Desenvolvimento (com hot-reload)\n\n```bash\nnpm run dev\n```\n\nVocÃª deve ver:\n\n```\nğŸš€ Servidor rodando em http://0.0.0.0:8000\nğŸ“ DocumentaÃ§Ã£o disponÃ­vel em http://0.0.0.0:8000/\nğŸ’š Health check em http://0.0.0.0:8000/health\n```\n\n### ProduÃ§Ã£o\n\n```bash\n# Compilar TypeScript\nnpm run build\n\n# Executar\nnpm start\n```\n\n---\n\n## âœ… Testar InstalaÃ§Ã£o\n\n### 1. Health Check\n\n```bash\ncurl http://localhost:8000/health\n\n# Resposta esperada:\n# {\"status\":\"ok\",\"timestamp\":\"...\",\"uptime\":...}\n```\n\n### 2. InformaÃ§Ãµes da API\n\n```bash\ncurl http://localhost:8000/\n\n# Resposta esperada:\n# {\"nome\":\"Chatbot BonnaVitta\",\"versao\":\"1.0.0\",\"endpoints\":{...}}\n```\n\n### 3. Teste de Login\n\n```bash\ncurl -X POST http://localhost:8000/api/auth/login \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"cpf\": \"12345678901\",\n    \"telefone\": \"11999999999\",\n    \"canal\": \"telegram\",\n    \"chatId\": \"123456789\"\n  }'\n\n# Resposta esperada:\n# {\"success\":true,\"token\":\"...\",\"usuario\":{...}}\n```\n\n---\n\n## ğŸ§ª Executar Testes\n\n```bash\n# Todos os testes\nnpm test\n\n# Testes especÃ­ficos\nnpm test auth.test.ts\nnpm test bot-flow.test.ts\n\n# Com coverage\nnpm run test:coverage\n\n# Em modo watch\nnpm run test:watch\n```\n\n---\n\n## ğŸ” Troubleshooting\n\n### Erro: \"Cannot find module 'express'\"\n\n```bash\n# SoluÃ§Ã£o: Reinstalar dependÃªncias\nrm -rf node_modules package-lock.json\nnpm install\n```\n\n### Erro: \"Connection refused\" (SQL Server)\n\n```bash\n# Verificar se SQL Server estÃ¡ rodando\n# Windows: Abra Services e procure por \"SQL Server\"\n# Mac/Linux: docker ps | grep mssql\n\n# Verificar credenciais em .env\n# Testar conexÃ£o:\nsqlcmd -S localhost -U sa -P \"YourPassword123!\" -Q \"SELECT 1\"\n```\n\n### Erro: \"Port 8000 already in use\"\n\n```bash\n# Mudar porta em .env\nPORT=3000\n\n# Ou matar processo usando porta 8000\n# Windows: netstat -ano | findstr :8000\n# Mac/Linux: lsof -i :8000 | kill -9 <PID>\n```\n\n### Erro: \"EACCES: permission denied\"\n\n```bash\n# SoluÃ§Ã£o: Usar sudo ou ajustar permissÃµes\nsudo npm install\n# Ou\nchmod -R 755 node_modules\n```\n\n---\n\n## ğŸ“š PrÃ³ximos Passos\n\n1. âœ… Ler **[COMECE_AQUI.md](./COMECE_AQUI.md)** - Guia rÃ¡pido\n2. âœ… Ler **[TESTING_GUIDE.md](./TESTING_GUIDE.md)** - Exemplos de testes\n3. âœ… Configurar **[Telegram](./docs/TELEGRAM_SETUP.md)**\n4. âœ… Configurar **[WhatsApp](./docs/WHATSAPP_SETUP.md)**\n5. âœ… Fazer deploy em **[Render](./docs/DEPLOY_RENDER.md)**\n\n---\n\n## ğŸ“ Precisa de Ajuda?\n\nConsulte os logs:\n\n```bash\n# Ver logs em tempo real\ntail -f logs/combined.log\n\n# Ver apenas erros\ntail -f logs/error.log\n```\n\nOu abra uma issue no repositÃ³rio.\n\n---\n\n**Tudo pronto! VocÃª estÃ¡ com o projeto rodando localmente! ğŸ‰**\n
