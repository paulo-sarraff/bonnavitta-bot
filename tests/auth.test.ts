import { describe, it, expect, beforeEach } from 'vitest';\nimport { authService } from '../src/services/auth.service.js';\nimport { validarCPF, validarTelefone, validarEmail } from '../src/utils/validators.js';\n\ndescribe('Auth Service', () => {\n  describe('JWT Token', () => {\n    it('deve gerar token válido', () => {\n      const usuario = {\n        id: 1,\n        cpf: '12345678901',\n        nome: 'João Silva',\n        email: 'joao@example.com',\n        telefone: '11999999999',\n        equipeId: 1,\n        nomeEquipe: 'Loja',\n        role: 'vendedor' as const,\n        ativo: true,\n      };\n\n      const token = authService.gerarToken(usuario);\n      expect(token).toBeTruthy();\n      expect(typeof token).toBe('string');\n    });\n\n    it('deve verificar token válido', () => {\n      const usuario = {\n        id: 1,\n        cpf: '12345678901',\n        nome: 'João Silva',\n        email: 'joao@example.com',\n        telefone: '11999999999',\n        equipeId: 1,\n        nomeEquipe: 'Loja',\n        role: 'vendedor' as const,\n        ativo: true,\n      };\n\n      const token = authService.gerarToken(usuario);\n      const decoded = authService.verificarToken(token);\n\n      expect(decoded).toBeTruthy();\n      expect(decoded.id).toBe(usuario.id);\n      expect(decoded.nome).toBe(usuario.nome);\n    });\n\n    it('deve rejeitar token inválido', () => {\n      const decoded = authService.verificarToken('token_invalido');\n      expect(decoded).toBeNull();\n    });\n  });\n\n  describe('Autorização', () => {\n    it('deve validar autorização para admin', () => {\n      const resultado = authService.validarAutorizacao('admin', ['admin', 'gerente']);\n      expect(resultado).toBe(true);\n    });\n\n    it('deve rejeitar autorização para role não permitido', () => {\n      const resultado = authService.validarAutorizacao('vendedor', ['admin', 'gerente']);\n      expect(resultado).toBe(false);\n    });\n\n    it('deve validar acesso à equipe para admin', () => {\n      const resultado = authService.validarAcessoEquipe('admin', 1, 2);\n      expect(resultado).toBe(true);\n    });\n\n    it('deve validar acesso à equipe para gerente da mesma equipe', () => {\n      const resultado = authService.validarAcessoEquipe('gerente', 1, 1);\n      expect(resultado).toBe(true);\n    });\n\n    it('deve rejeitar acesso à equipe diferente para gerente', () => {\n      const resultado = authService.validarAcessoEquipe('gerente', 1, 2);\n      expect(resultado).toBe(false);\n    });\n  });\n});\n\ndescribe('Validators', () => {\n  describe('CPF', () => {\n    it('deve validar CPF com 11 dígitos', () => {\n      expect(validarCPF('12345678901')).toBe(true);\n    });\n\n    it('deve rejeitar CPF com menos de 11 dígitos', () => {\n      expect(validarCPF('1234567890')).toBe(false);\n    });\n\n    it('deve rejeitar CPF com todos os dígitos iguais', () => {\n      expect(validarCPF('11111111111')).toBe(false);\n    });\n  });\n\n  describe('Telefone', () => {\n    it('deve validar telefone com 10 dígitos', () => {\n      expect(validarTelefone('1133334444')).toBe(true);\n    });\n\n    it('deve validar telefone com 11 dígitos', () => {\n      expect(validarTelefone('11999999999')).toBe(true);\n    });\n\n    it('deve rejeitar telefone com menos de 10 dígitos', () => {\n      expect(validarTelefone('119999999')).toBe(false);\n    });\n  });\n\n  describe('Email', () => {\n    it('deve validar email válido', () => {\n      expect(validarEmail('joao@example.com')).toBe(true);\n    });\n\n    it('deve rejeitar email sem @', () => {\n      expect(validarEmail('joaoexample.com')).toBe(false);\n    });\n\n    it('deve rejeitar email sem domínio', () => {\n      expect(validarEmail('joao@')).toBe(false);\n    });\n  });\n});\n
